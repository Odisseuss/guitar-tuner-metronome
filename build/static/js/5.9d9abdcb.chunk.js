(this["webpackJsonpguitar-tuner-metronome"]=this["webpackJsonpguitar-tuner-metronome"]||[]).push([[5],{50:function(t,e,n){"use strict";var r=n(19),i=n(8),a=n(3),o=n(0),s=n(9);function c(){return(c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function u(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var l=o.createElement("path",{d:"M14.5 0.989563L8.64046 2.56123L0.935874 31.3637C0.884624 31.62 0.833374 31.8933 0.833374 32.1666C0.833374 34.0629 2.35379 35.5833 4.25004 35.5833H24.75C26.6463 35.5833 28.1667 34.0629 28.1667 32.1666C28.1667 31.8933 28.1155 31.62 28.0642 31.3637L25.7409 22.6341L23.0417 25.3333L23.3834 27.0416H16.9088L21.7605 22.19L19.3517 19.7812L12.0913 27.0416H5.61671L11.5788 4.83331H17.4213L19.9155 14.1096L22.7 11.3079L20.3596 2.56123L14.5 0.989563ZM13.2188 6.54165V23.1979L15.7813 20.6354V6.54165H13.2188ZM27.808 11.325L22.9734 16.1596L21.7605 14.9466L19.3517 17.3725L24.1692 22.19L26.595 19.7812L25.3821 18.5683L30.2167 13.7337L27.808 11.325Z",fill:"current"});function d(t,e){var n=t.title,r=t.titleId,i=u(t,["title","titleId"]);return o.createElement("svg",c({width:31,height:36,viewBox:"0 0 31 36",fill:"current",xmlns:"http://www.w3.org/2000/svg",ref:e,"aria-labelledby":r},i),n?o.createElement("title",{id:r},n):null,l)}var h=o.forwardRef(d);n.p;function f(){return(f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function g(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var p=o.createElement("path",{d:"M32.6975 22.1059C32.7659 21.5934 32.8 21.0638 32.8 20.5C32.8 19.9534 32.7659 19.4067 32.6804 18.8942L36.1484 16.195C36.4559 15.9559 36.5413 15.4946 36.3534 15.153L33.0734 9.48129C32.8684 9.10545 32.4413 8.98587 32.0654 9.10545L27.9825 10.7455C27.1284 10.0963 26.2229 9.54962 25.215 9.13962L24.6 4.80045C24.5317 4.39045 24.19 4.10004 23.78 4.10004H17.22C16.81 4.10004 16.4854 4.39045 16.4171 4.80045L15.8021 9.13962C14.7942 9.54962 13.8717 10.1134 13.0346 10.7455L8.95169 9.10545C8.57586 8.96879 8.14877 9.10545 7.94377 9.48129L4.68086 15.153C4.47586 15.5117 4.54419 15.9559 4.88586 16.195L8.35377 18.8942C8.26836 19.4067 8.20003 19.9705 8.20003 20.5C8.20003 21.0296 8.23419 21.5934 8.31961 22.1059L4.85169 24.805C4.54419 25.0442 4.45877 25.5055 4.64669 25.8471L7.92669 31.5188C8.13169 31.8946 8.55877 32.0142 8.93461 31.8946L13.0175 30.2546C13.8717 30.9038 14.7771 31.4505 15.785 31.8605L16.4 36.1996C16.4854 36.6096 16.81 36.9 17.22 36.9H23.78C24.19 36.9 24.5317 36.6096 24.5829 36.1996L25.1979 31.8605C26.2059 31.4505 27.1284 30.9038 27.9654 30.2546L32.0484 31.8946C32.4242 32.0313 32.8513 31.8946 33.0563 31.5188L36.3363 25.8471C36.5413 25.4713 36.4559 25.0442 36.1313 24.805L32.6975 22.1059ZM20.5 26.65C17.1175 26.65 14.35 23.8825 14.35 20.5C14.35 17.1175 17.1175 14.35 20.5 14.35C23.8825 14.35 26.65 17.1175 26.65 20.5C26.65 23.8825 23.8825 26.65 20.5 26.65Z",fill:"current"});function m(t,e){var n=t.title,r=t.titleId,i=g(t,["title","titleId"]);return o.createElement("svg",f({width:36,height:36,viewBox:"0 0 36 36",fill:"current",xmlns:"http://www.w3.org/2000/svg",ref:e,"aria-labelledby":r},i),n?o.createElement("title",{id:r},n):null,p)}var b=o.forwardRef(m),v=(n.p,n(1)),y=n(21),j=function(t,e){Object(o.useEffect)((function(){function n(n){t.current&&!t.current.contains(n.target)&&e()}return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}}),[t,e])};function C(){var t=Object(i.a)(["\n\ttransition: all 0.2s;\n"]);return C=function(){return t},t}function x(){var t=Object(i.a)(["\n\tposition: absolute;\n\tleft: 30px;\n\ttransition: fill 0.2s;\n"]);return x=function(){return t},t}function _(){var t=Object(i.a)(["\n\tborder: 1px solid transparent;\n\tfont-size: 0.875rem;\n\tfont-weight: 400;\n\tpadding: 10px 15px;\n\tposition: relative;\n\tcolor: #333;\n\tcursor: pointer;\n\tmargin: 0;\n\tdisplay: flex;\n\talign-items: center;\n\n\t& button {\n\t\tcursor: pointer;\n\t\tbackground: transparent;\n\t\tcolor: white;\n\t\tborder: none;\n\t\toutline: none;\n\t}\n\t&:hover {\n\t\tborder: 1px solid white;\n\t}\n"]);return _=function(){return t},t}function O(){var t=Object(i.a)(["\n\tbackground-color: #202124;\n\tborder-width: 0;\n\tbox-shadow: 0 1px 2px 0 rgb(0 0 0 / 30%), 0 2px 6px 2px rgb(0 0 0 / 15%);\n\tposition: absolute;\n\ttop: 100%;\n\tright: 0;\n\twidth: 150px;\n\tz-index: 9999;\n\topacity: 0;\n\ttransition: opacity 0.2s;\n"]);return O=function(){return t},t}function w(){var t=Object(i.a)(["\n\tfont-size: 18px;\n\tfont-weight: 500;\n\ttext-transform: uppercase;\n\tdisplay: inline-block;\n"]);return w=function(){return t},t}function F(){var t=Object(i.a)(["\n\theight: 10%;\n\twidth: 100%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n"]);return F=function(){return t},t}var S=s.b.div(F()),q=s.b.h1(w()),k=s.b.div(O()),T=s.b.div(_()),D=Object(s.b)(h)(x()),L=Object(s.b)(b)(C());e.a=function(t){var e=t.setColors,n=t.navigateLocation,i=t.menuColor,s=t.handleStartTapTempo,c=t.cycleNoteType,u=t.tapTempoActive,l=t.toggleChromaticMode,d=t.chromaticMode,h=o.useState(!1),f=Object(r.a)(h,2),g=f[0],p=f[1],m=o.useRef(null),b=Object(v.f)();o.useEffect((function(){var t="/"===b.pathname?{primary:"#F72640",gradient_darker:"#0F0910",gradient_lighter:"#1F0E18"}:{primary:"#FFFFFF",gradient_darker:"#0F0F0F",gradient_lighter:"#282828"};e(t)}),[b.pathname,e]);return j(m,(function(){p(!1)})),Object(a.jsxs)(S,{children:[Object(a.jsx)(y.b,{to:n,style:{height:"100%",display:"flex",alignItems:"center"},children:Object(a.jsx)(D,{fill:"/"===n?"#FFFFFF":"#969696"})}),Object(a.jsx)(q,{children:"Guitune"}),Object(a.jsxs)("div",{style:{position:"absolute",right:"30px"},ref:m,children:[Object(a.jsx)("button",{style:{outline:"none",border:"none",background:"transparent",padding:0},onClick:function(){p(!g)},children:Object(a.jsx)(L,{fill:g?"#FFFFFF":"#969696"})}),Object(a.jsx)(k,{className:"dropdown",style:{background:i,opacity:g?1:0,zIndex:g?9999:-100},children:"/"===b.pathname?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(T,{children:Object(a.jsx)("button",{children:"Tutorial"})}),Object(a.jsx)(T,{children:Object(a.jsx)("button",{onClick:function(){l&&d&&l()},children:"Chromatic Mode"})})]}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(T,{children:Object(a.jsx)("button",{onClick:function(){s&&void 0!=u&&s(u?"stop":"start")},children:"Tap Tempo"})}),Object(a.jsx)(T,{children:Object(a.jsx)("button",{onClick:function(){c&&c()},children:"Note Type"})})]})})]})]})}},69:function(t,e,n){"use strict";n.r(e);var r=n(44),i=n.n(r),a=n(45),o=n(40),s=n(41),c=n(46),u=n(42),l=n(43),d=n(3),h=n(0),f=n.n(h),g={Standard:{frequencies:{string_1:82,string_2:110,string_3:146,string_4:196,string_5:246,string_6:329},letters:{string_1:"E",string_2:"A",string_3:"D",string_4:"G",string_5:"B",string_6:"E"}},"Drop D":{frequencies:{string_1:73,string_2:110,string_3:146,string_4:196,string_5:246,string_6:329},letters:{string_1:"D",string_2:"A",string_3:"D",string_4:"G",string_5:"B",string_6:"E"}},"Double Drop D":{frequencies:{string_1:73,string_2:110,string_3:146,string_4:196,string_5:246,string_6:293},letters:{string_1:"D",string_2:"A",string_3:"D",string_4:"G",string_5:"B",string_6:"D"}},DADGAD:{frequencies:{string_1:73,string_2:110,string_3:146,string_4:196,string_5:220,string_6:293},letters:{string_1:"D",string_2:"A",string_3:"D",string_4:"G",string_5:"A",string_6:"D"}},"Open D":{frequencies:{string_1:73,string_2:110,string_3:146,string_4:185,string_5:220,string_6:293},letters:{string_1:"D",string_2:"A",string_3:"D",string_4:"F#",string_5:"A",string_6:"D"}},"Open E":{frequencies:{string_1:82,string_2:123,string_3:164,string_4:207,string_5:246,string_6:329},letters:{string_1:"E",string_2:"B",string_3:"E",string_4:"G#",string_5:"B",string_6:"E"}},"Open G":{frequencies:{string_1:73,string_2:98,string_3:146,string_4:185,string_5:246,string_6:293},letters:{string_1:"D",string_2:"G",string_3:"D",string_4:"G",string_5:"B",string_6:"D"}}},p={primary:"#F72640",gradient_lighter:"#1F0E18",gradient_darker:"#0F0910"},m={primary:"#F79726",gradient_lighter:"#1F170E",gradient_darker:"#100C09"},b={primary:"#F7C926",gradient_lighter:"#1F1C0E",gradient_darker:"#100F09"},v={primary:"#26F761",gradient_lighter:"#0E1F13",gradient_darker:"#09100C"},y={primary:"#269FF7",gradient_lighter:"#0E191F",gradient_darker:"#090D10"},j={primary:"#5026F7",gradient_lighter:"#100E1F",gradient_darker:"#0B0910"},C={primary:"#9B26F7",gradient_lighter:"#180E1F",gradient_darker:"#0D0910"},x={A:p,"A#":p,B:m,"B#":m,C:b,"C#":b,D:v,"D#":v,E:y,"E#":y,F:j,"F#":j,G:C,"G#":C};function _(t,e){return t[e]}function O(t){var e=Math.log(t/440)/Math.log(2)*12;return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][(Math.round(e)+69)%12]}var w=n(58),F=Object(w.a)(fetch("yin-optimized.wasm")).then((function(t){var e=t.exports;return Object.assign({},e,{YinDetector:function(t,n,r,i){var a=e.__retain(e.__newArray(e.Float32AudioBuffer_ID,t)),o=e.getPitch(a,n,r,i,t.length);return e.__release(a),o}})}));Object(w.a)(fetch("ac-optimized.wasm")).then((function(t){var e=t.exports;return Object.assign({},e,{ACDetector:function(t,n){var r=e.__retain(e.__newArray(e.Float32AudioBuffer_ID,t)),i=e.autocorellation(r,n);return e.__release(r),i}})}));function S(){return F.then((function(t){return t.YinDetector})).catch((function(t){return console.log(t)}))}var q=n(55),k=n(8),T=n(9);function D(){return(D=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function L(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var M=h.createElement("path",{d:"M43.9664 82.1234C31.9756 82.1234 19.4851 141.791 0 141.791V373H654V141.791C627.021 141.791 616.529 82.1234 604.538 82.1234C592.547 82.1234 596.044 141.791 553.077 141.791C510.11 141.791 521.102 1.35937e-06 460.148 0C399.195 -1.35937e-06 424.176 141.791 321.254 141.791C218.333 141.791 228.825 0 176.365 0C123.905 0 108.417 141.791 86.4339 141.791C64.4507 141.791 55.9572 82.1234 43.9664 82.1234Z",fill:"url(#paint0_radial)"}),A=h.createElement("defs",null,h.createElement("radialGradient",{id:"paint0_radial",cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(327) rotate(90) scale(480.301 842.137)"},h.createElement("stop",{stopColor:"var(--color-1)"}),h.createElement("stop",{offset:1,stopColor:"var(--color-2)"})));function I(t,e){var n=t.title,r=t.titleId,i=L(t,["title","titleId"]);return h.createElement("svg",D({viewBox:"0 0 650 373",fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMin slice",ref:e,"aria-labelledby":r},i),n?h.createElement("title",{id:r},n):null,M,A)}var E=h.forwardRef(I),B=(n.p,n(56));function P(){var t=Object(k.a)(["\n  z-index: 99999;\n  position: absolute;\n  bottom: 0;\n  width: 100%;\n  display: flex;\n  justify-content: space-evenly;\n  align-items: flex-end;\n"]);return P=function(){return t},t}var G=T.b.div(P()),z=function(t){var e=t.rulerGradings,n=t.gradingColors,r=t.rulerTranslate,i=Object(B.b)();return h.useEffect((function(){i.start({translateX:r,transition:{duration:.15}})}),[r,i]),Object(d.jsxs)(G,{children:[e,Object(d.jsx)(B.a.div,{animate:i,style:{position:"absolute",width:"3px",height:110,backgroundColor:n}})]})};function N(){var t=Object(k.a)(["\n\tmargin: 0;\n\tmargin-top: 20px;\n\tcolor: #777777;\n\tfont-size: 18px;\n\tfont-weight: 400;\n"]);return N=function(){return t},t}function W(){var t=Object(k.a)(["\n\tmargin: 0;\n\tcolor: ",";\n\tfont-size: 144px;\n\tline-height: 144px;\n\tfont-weight: 400;\n"]);return W=function(){return t},t}function Y(){var t=Object(k.a)(["\n\tfont-size: 40px;\n\tline-height: 144px;\n\tfont-weight: 400;\n"]);return Y=function(){return t},t}function H(){var t=Object(k.a)(["\n\tmargin-top: 3rem;\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n\talign-items: center;\n"]);return H=function(){return t},t}var R=T.b.div(H()),V=T.b.sup(Y()),Z=T.b.h1(W(),(function(t){return t.color})),U=T.b.p(N()),J=h.memo((function(t){var e=t.note.split(""),n=Object(d.jsx)(Z,{color:t.noteProps.color,children:t.note});return 1!==e.length&&(n=Object(d.jsxs)(Z,{color:t.noteProps.color,children:[e[0],Object(d.jsx)(V,{children:e[1]})]})),Object(d.jsxs)(R,{onClick:t.toggleLiveInput,children:[n,Object(d.jsxs)(U,{children:[t.frequency,"Hz"]})]})})),X=n(19);function K(){var t=Object(k.a)(["\n\tfont-weight: 500;\n\tfont-size: 18px;\n\tcolor: #777777;\n\tborder-radius: 66px;\n\toutline: none;\n\tborder: none;\n\tpadding: 10px 30px;\n\tbackground-color: transparent;\n\tmargin: 0px 10px;\n"]);return K=function(){return t},t}var Q=Object(T.b)(B.a.button)(K()),$=h.memo((function(t){return Object(d.jsx)(Q,{animate:t.selected?{color:"#ffffff",backgroundColor:"rgba(150, 150, 150, 0.2)",transition:{duration:.35}}:{color:"#777777",backgroundColor:"rgba(150, 150, 150, 0)",transition:{duration:.35}},onClick:t.onClick,selected:t.selected,children:t.children})}),(function(t,e){return t.selected===e.selected}));function tt(){var t=Object(k.a)(["\n\twidth: calc(100% - 30px);\n\toverflow-x: auto;\n\tpadding-left: 15px;\n\tpadding-top: 30px;\n\tdisplay: flex;\n\talign-items: center;\n\twhite-space: nowrap;\n\t::-webkit-scrollbar {\n\t\twidth: 0px;\n\t}\n"]);return tt=function(){return t},t}var et=T.b.div(tt()),nt=Object.keys(g),rt=h.memo((function(t){var e=function(){var t=Object(h.useRef)();return Object(h.useEffect)((function(){var e=t.current;if(e){var n=function(t){0!==t.deltaY&&(0===e.scrollLeft&&t.deltaY<0||e.scrollWidth-e.clientWidth-Math.round(e.scrollLeft)===0&&t.deltaY>0||t.preventDefault(),e.scrollTo({left:e.scrollLeft+t.deltaY,behavior:"smooth"}))};return e.addEventListener("wheel",n),function(){return e.removeEventListener("wheel",n)}}}),[]),t}(),n=h.useState(0),r=Object(X.a)(n,2),i=r[0],a=r[1],o=nt.map((function(e,n){var r=n===i;return Object(d.jsx)($,{selected:r,onClick:function(r){t.onClick(r,e),a(n)},children:e},n)}));return Object(d.jsx)(et,{ref:e,style:{visibility:t.isChromaticMode?"hidden":"visible"},children:o})}));function it(){var t=Object(k.a)(["\n\twidth: 100%;\n\theight: 100%;\n\tposition: absolute;\n\tmax-height: 373px;\n\t--color-1: ",";\n\t--color-2: ",";\n\tfilter: drop-shadow(0px 0px 10px rgba(0, 0, 0, 0.15));\n"]);return it=function(){return t},t}function at(){var t=Object(k.a)(["\n\twidth: 100%;\n\theight: 45%;\n\tposition: absolute;\n\tbottom: 0;\n"]);return at=function(){return t},t}var ot=T.b.div(at()),st=Object(T.b)(E)(it(),(function(t){return t.color_1}),(function(t){return t.color_2})),ct=function(t){var e=t.handleTuningSelection,n=t.toggleLiveInput,r=(t.startOscillator,t.currentStringBeingTuned),i=t.currentColors,a=t.frequency,o=t.rulerDivs,s=t.rulerTranslate,c=t.tuningIndication,u=(t.timeToCompute,t.isChromaticMode),l=t.currentNote;return Object(d.jsxs)("div",{style:{height:"90%",width:"100%",position:"relative"},children:[Object(d.jsx)(rt,{onClick:e,isChromaticMode:u}),Object(d.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:Object(d.jsx)(J,{note:u?l:r.letter,frequency:r.frequency,noteProps:{color:i.primary},toggleLiveInput:n})}),Object(d.jsxs)(ot,{children:[Object(d.jsxs)("h1",{style:{position:"absolute",width:"100%",top:"45%",fontWeight:400,fontSize:18,textAlign:"center",zIndex:100,color:i.primary},children:[a,"Hz"]}),Object(d.jsx)("h1",{style:{position:"absolute",width:"100%",top:"55%",fontWeight:400,fontSize:18,textAlign:"center",zIndex:100,color:i.primary},children:c}),!u&&Object(d.jsx)(z,{rulerGradings:o,gradingColors:i.primary,rulerTranslate:s}),Object(d.jsx)(st,{color_1:i.gradient_lighter,color_2:i.gradient_darker,style:{position:"absolute",bottom:0,left:0}})]})]})},ut=n(50),lt=h.createContext(!1),dt=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).yinDetector=void 0,r.state={analyser:void 0,audioContext:void 0,buffer:new Float32Array(2048),frequency:0,timeToCompute:0,note:"-",mediaStreamSource:void 0,oscillatorNode:void 0,isPlaying:!1,requestAnimationFrameID:void 0,currentTuning:"Standard",currentStringBeingTuned:{frequency:0,letter:"-"},windowWidth:650,rulerDistanceBetweenGradings:27.083333333333332,sameFrequencyCounter:0,isChromatic:!1},r.gotStream=r.gotStream.bind(Object(c.a)(r)),r.findPitch=r.findPitch.bind(Object(c.a)(r)),r.findPitchWithYIN=r.findPitchWithYIN.bind(Object(c.a)(r)),r.liveInput=r.liveInput.bind(Object(c.a)(r)),r.oscillator=r.oscillator.bind(Object(c.a)(r)),r.handleTuningSelection=r.handleTuningSelection.bind(Object(c.a)(r)),r.toggleChromaticMode=r.toggleChromaticMode.bind(Object(c.a)(r)),r.chromaticMode=r.chromaticMode.bind(Object(c.a)(r)),r.liveInputModePicker=r.liveInputModePicker.bind(Object(c.a)(r)),r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var t=this;window.addEventListener("resize",(function(e){var n=Math.min(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth,650);t.setState({rulerDistanceBetweenGradings:n/24,windowWidth:n})}))}},{key:"toggleChromaticMode",value:function(){this.setState((function(t){return{isChromatic:!t.isChromatic}}))}},{key:"gotStream",value:function(t,e){var n,r,i=this.state.analyser;i&&(i.fftSize=4096),this.state.audioContext&&((n=this.state.audioContext.createGain()).gain.value=2,(r=this.state.audioContext.createMediaStreamSource(t)).connect(n),i&&n.connect(i)),this.setState({mediaStreamSource:r,analyser:i,isPlaying:!0}),e()}},{key:"findPitchWithYIN",value:function(){var t=Object(a.a)(i.a.mark((function t(){var e,n,r,a,o,s,c,u,l=this;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state.analyser&&(e=new Float32Array(2048),this.state.analyser.getFloatTimeDomainData(e),this.setState({buffer:e})),n=0,r=performance.now(),!this.state.audioContext){t.next=8;break}return t.next=6,S();case 6:(a=t.sent)&&(n=a(this.state.buffer,.3,this.state.audioContext.sampleRate,.95));case 8:o=performance.now(),this.setState({timeToCompute:o-r}),-1!==n&&n>30&&n<1048?(s=Math.round(n),c=Math.abs(this.state.frequency-s),Math.round(s)===this.state.frequency&&this.setState((function(t){return t.sameFrequencyCounter+1===10?{sameFrequencyCounter:0}:{sameFrequencyCounter:t.sameFrequencyCounter+1}})),c>1||c<20||(s=this.state.frequency),this.setState({frequency:s,note:O(s)})):this.setState({frequency:0,note:"-"}),u=window.requestAnimationFrame((function(){return l.setStringCurrentlyBeingTuned(l.state.currentTuning,l.findPitchWithYIN)})),this.setState({requestAnimationFrameID:u});case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"findPitch",value:function(){var t=this;if(this.state.analyser){var e=new Float32Array(2048);this.state.analyser.getFloatTimeDomainData(e),this.setState({buffer:e})}var n=performance.now(),r=0;this.state.audioContext&&(r=function(t,e){for(var n=0,r=t.length,i=0;i<r;i++){var a=t[i];n+=a*a}if((n=Math.sqrt(n/r))<.01)return-1;for(var o=0,s=r-1,c=0;c<r/2;c++)if(Math.abs(t[c])<.2){o=c;break}for(var u=0;u<r/2;u++)if(Math.abs(t[r-1])<.2){s=r-u;break}r=(t=t.slice(o,s)).length;for(var l=new Array(r).fill(0),d=0;d<r;d++)for(var h=0;h<r-d;h++)l[d]=l[d]+t[h]*t[h+d];for(var f=0;l[f]>l[f+1];)f++;for(var g=-1,p=-1,m=f;m<r;m++)l[m]>g&&(g=l[m],p=m);var b=p,v=l[b-1],y=l[b],j=l[b+1],C=(v+j-2*y)/2;return C&&(b-=(j-v)/2/(2*C)),e/b}(this.state.buffer,this.state.audioContext.sampleRate));var i=performance.now();if(-1!==r){var a=r;this.setState({frequency:Math.floor(a),note:O(a)})}else this.setState({frequency:0,note:"-"});this.setState({timeToCompute:i-n});var o=window.requestAnimationFrame((function(){return t.setStringCurrentlyBeingTuned(t.state.currentTuning,t.findPitch)}));this.setState({requestAnimationFrameID:o})}},{key:"liveInputModePicker",value:function(){this.state.isChromatic?this.liveInput(this.chromaticMode):this.liveInput(this.findPitchWithYIN)}},{key:"chromaticMode",value:function(){var t=Object(a.a)(i.a.mark((function t(){var e,n,r,a,o,s,c,u,l=this;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state.analyser&&(e=new Float32Array(2048),this.state.analyser.getFloatTimeDomainData(e),this.setState({buffer:e})),n=0,r=performance.now(),!this.state.audioContext){t.next=8;break}return t.next=6,S();case 6:(a=t.sent)&&(n=a(this.state.buffer,.3,this.state.audioContext.sampleRate,.95));case 8:o=performance.now(),this.setState({timeToCompute:o-r}),-1!==n&&n>30&&n<1048?(s=Math.round(n),c=Math.abs(this.state.frequency-s),Math.round(s)===this.state.frequency&&this.setState((function(t){return t.sameFrequencyCounter+1===10?{sameFrequencyCounter:0}:{sameFrequencyCounter:t.sameFrequencyCounter+1}})),c>1||c<20||(s=this.state.frequency),this.setState({frequency:s,note:O(s)})):this.setState({frequency:0,note:"-"}),u=window.requestAnimationFrame((function(){return l.setColorsFromNote(O(Math.round(n)),l.chromaticMode)})),this.setState({requestAnimationFrameID:u});case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setColorsFromNote",value:function(t,e){if(0!==this.state.frequency&&this.state.audioContext){var n=function(t){return{currentColors:_(x,t)}}(t);this.props.setColors(n.currentColors)}setTimeout((function(){requestAnimationFrame(e)}),25)}},{key:"setStringCurrentlyBeingTuned",value:function(t,e){if(0!==this.state.frequency&&this.state.audioContext){var n=function(t,e){var n,r=_(_(g,t),"frequencies"),i=_(_(g,t),"letters"),a=e,o=9999,s=0;return console.log(a),Object.values(r).map((function(t,e){var n=Math.abs(a-t);return n<o+2&&0!==a&&(o=n,s=e),null})),{currentStringBeingTuned:{letter:n=_(i,"string_".concat(s+1)),frequency:_(r,"string_".concat(s+1))},currentColors:_(x,n)}}(t,this.state.frequency);this.props.setColors(n.currentColors),this.setState({currentStringBeingTuned:n.currentStringBeingTuned})}else this.setState({currentStringBeingTuned:{letter:"-",frequency:0}});setTimeout((function(){requestAnimationFrame(e)}),25)}},{key:"liveInput",value:function(t){var e=this;if(this.state.isPlaying){var n;null===(n=this.state.oscillatorNode)||void 0===n||n.stop(),this.state.requestAnimationFrameID&&window.cancelAnimationFrame(this.state.requestAnimationFrameID),this.props.setColors({primary:x.A.primary,gradient_lighter:x.A.gradient_lighter,gradient_darker:x.A.gradient_darker}),this.setState({isPlaying:!1,oscillatorNode:void 0,analyser:void 0,frequency:0,timeToCompute:0,note:"-"})}else{var r=new q.a;this.setState({audioContext:r,analyser:r.createAnalyser()}),navigator.mediaDevices.getUserMedia({audio:{autoGainControl:!1,noiseSuppression:!1}}).then((function(n){return e.gotStream(n,t)})).catch((function(t){console.log("Getusermedia threw error: "+t)}))}}},{key:"oscillator",value:function(){this.state.isPlaying&&(this.state.oscillatorNode&&this.state.oscillatorNode.stop(0),this.setState({oscillatorNode:void 0,analyser:void 0,isPlaying:!1}),this.state.requestAnimationFrameID&&window.cancelAnimationFrame(this.state.requestAnimationFrameID));var t=new q.a,e=t.createAnalyser();e.fftSize=4096;var n=t.createOscillator();n.connect(e),e.connect(t.destination);var r=t.createGain();r.connect(t.destination),r.gain.value=-.95,n.connect(r);var i=60;n.frequency.setValueAtTime(i,t.currentTime),setInterval((function(){n.frequency.setValueAtTime(i,t.currentTime),i+=1}),50),n.start(0),this.setState({audioContext:t,analyser:e,oscillatorNode:n,isPlaying:!0}),this.findPitchWithYIN()}},{key:"handleTuningSelection",value:function(t,e){this.setState({currentTuning:e})}},{key:"render",value:function(){var t,e=new Array(23).fill(0).map((function(t,e){var n;return n=0===e||(e-1)%5!==0?60:110,Object(d.jsx)("div",{style:{width:"3px",height:n+"px",backgroundColor:"rgba(51, 51, 51, 70)"}},e)})),n=this.state.windowWidth/2-this.state.rulerDistanceBetweenGradings,r=Math.abs(this.state.frequency-this.state.currentStringBeingTuned.frequency)/5*this.state.rulerDistanceBetweenGradings>n,i=this.state.frequency-this.state.currentStringBeingTuned.frequency<0?-1:1,a=0!==this.state.frequency?r?i*n:(this.state.frequency-this.state.currentStringBeingTuned.frequency)/5*this.state.rulerDistanceBetweenGradings:0;return t=0!==this.state.frequency?this.state.frequency<this.state.currentStringBeingTuned.frequency?"Tune Higher":this.state.frequency>this.state.currentStringBeingTuned.frequency?"Tune Lower":"In Tune":"",console.log("CHROMATIC",this.state.isChromatic),Object(d.jsx)(lt.Provider,{value:this.state.isChromatic,children:Object(d.jsxs)(f.a.Fragment,{children:[Object(d.jsx)(ut.a,{navigateLocation:"/metronome",setColors:this.props.setColors,menuColor:this.props.currentColors.gradient_lighter,toggleChromaticMode:this.toggleChromaticMode,chromaticMode:this.chromaticMode}),Object(d.jsx)(ct,{currentColors:this.props.currentColors,currentStringBeingTuned:this.state.currentStringBeingTuned,currentNote:this.state.note,frequency:this.state.frequency,handleTuningSelection:this.handleTuningSelection,rulerDivs:e,rulerTranslate:a,toggleLiveInput:this.liveInputModePicker,startOscillator:this.oscillator,timeToCompute:this.state.timeToCompute,tuningIndication:t,isChromaticMode:this.state.isChromatic})]})})}}]),n}(f.a.Component);dt.contextType=lt;e.default=dt}}]);
//# sourceMappingURL=5.9d9abdcb.chunk.js.map